<% content_for :title, "Letters" %>

<header class="container">
  <div class="grid">
    <div>
      <h1>Letters</h1>
    </div>
    <div class="text-right">
      <%= success_link_to new_letter_path, class: "button outline contrast" do %>
        <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
        </svg>
        Create New Letter
      <% end %>
    </div>
  </div>
</header>

<nav class="container">
  <ul class="nav-tabs">
    <li><%= link_to "Unbatched Letters", letters_path, class: "#{params[:view] != 'batched' ? 'contrast' : ''}" %></li>
    <li><%= link_to "Batched Letters", letters_path(view: 'batched'), class: "#{params[:view] == 'batched' ? 'contrast' : ''}" %></li>
  </ul>
</nav>

<main class="container">
  <% if params[:view] == 'batched' %>
      <header>
        <h2>Batched Letters</h2>
      </header>
      <% if @batched_letters.any? %>
          <% @batched_letters.each do |batch, letters| %>
          <article class="card">
            <details>
              <summary>
                <div>
                  <strong>Batch #<%= batch.id %></strong>
                  <small><%= pluralize(letters.size, 'letter') %></small>
                  <div class="text-muted">
                    <small>Created <%= time_ago_in_words(batch.created_at) %> ago</small>
                  </div>
                </div>
              </summary>
              <div class="content">
                <%= render partial: 'batches/letters_collection', locals: { letters: letters } %>
              </div>
            </details>
          </article>
          <% end %>
      <% else %>
        <p class="text-center">No batched letters found.</p>
      <% end %>
  <% else %>
      <header>
        <h2>Unbatched Letters</h2>
      </header>
      <% if @unbatched_letters.any? %>
          <%= render partial: 'batches/letters_collection', locals: { letters: @unbatched_letters } %>
      <% else %>
        <p class="text-center">No unbatched letters found.</p>
      <% end %>
  <% end %>
</main>

<% if params[:view] != 'batched' %>
  <footer class="container">
    <%= paginate @unbatched_letters %>
  </footer>
<% end %>

<!-- Add this to your CSS -->
<style>
[data-theme="dark"] {
  --primary: #00b894;
  --primary-hover: #00a884;
}

.letters-grid .card {
  background: var(--card-background-color);
  padding: 1rem;
  border-radius: var(--border-radius);
  border: 1px solid var(--card-border-color);
}

.nav-tabs {
  border-bottom: 1px solid var(--card-border-color);
  padding: 0;
  list-style: none;
  display: flex;
  gap: 1rem;
}

.nav-tabs li a {
  padding: 0.5rem 1rem;
  text-decoration: none;
  color: var(--color);
}

.nav-tabs li a.contrast {
  border-bottom: 2px solid var(--primary);
  color: var(--primary);
}
</style>